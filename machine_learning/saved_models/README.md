# Hedge Your Bets - Trained ML Models

**Training Date:** 2025-10-19 22:54:48
**Data Range:** 2020-2024 NFL Season Data
**Total Records:** 93,026

## üì¶ Directory Contents

### Model Files (*.joblib)
Quantile regression models trained on NFL player statistics. Each position-stat combination has 3 quantile models:
- `q10` = 10th percentile (pessimistic prediction)
- `q50` = 50th percentile (median/most likely prediction)
- `q90` = 90th percentile (optimistic prediction)

**Naming Convention:** `{POSITION}_{STAT}_q{QUANTILE}.joblib`

Example: `QB_passing_yards_q50.joblib` is the median passing yards model for quarterbacks.

### Metadata Files
- `model_metadata.joblib` - Complete training metadata, stats, and model performance
- `feature_columns.joblib` - Feature lists for each model (CRITICAL for predictions)

### Python Modules
- `inference_preprocessing.py` - Preprocessing utilities for making predictions

## üèà Model Coverage

### Quarterback (QB)
- Completions
- Passing Interceptions
- Passing Tds
- Passing Yards
- Rushing Yards

### Running Back (RB)
- Receiving Tds
- Receiving Yards
- Receptions
- Rushing Tds
- Rushing Yards

### Wide Receiver (WR)
- Receiving Tds
- Receiving Yards
- Receptions
- Targets

### Tight End (TE)
- Receiving Tds
- Receiving Yards
- Receptions

## üìä Model Statistics

- **Algorithm:** LightGBM Quantile Regression
- **Training Method:** Per-position models with position-specific features
- **Features:** 20-27 features per position including:
  - Rolling averages (3-game and 5-game windows)
  - Team context statistics
  - Temporal features (season progression, playoff indicator)
  
## üöÄ Usage in Production

### Loading a Model

```python
import joblib

# Load a model
model = joblib.load('QB_passing_yards_q50.joblib')

# Load feature columns (REQUIRED!)
feature_columns = joblib.load('feature_columns.joblib')
features = feature_columns['QB_passing_yards']

# Make prediction (ensure features match exactly)
prediction = model.predict(your_features_dataframe[features])
```

### Important Notes

1. **Feature Order Matters:** Always use the exact feature list from `feature_columns.joblib`
2. **Rolling Features Required:** Models need player's last 3-5 games to calculate rolling averages
3. **Team Context:** Models expect team-level statistics for the game
4. **Data Preprocessing:** Use `inference_preprocessing.py` to prepare features correctly

## ‚ö†Ô∏è Important Considerations

- Models trained on 2020-2024 data - performance may degrade with future seasons
- Models assume similar stat distributions - major rule changes could affect accuracy
- Always validate that requested position-stat combinations have trained models
- Handle edge cases: rookies (no history), injured players (stale data), etc.

---
*Generated by model_training.ipynb*
*For questions or issues, refer to the training notebook*
